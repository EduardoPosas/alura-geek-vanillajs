import"./style-429ee022.js";import{b as y,u as g,c as v}from"./ProductService-4ab90952.js";import{C as S}from"./CategoryService-5452352c.js";import{a as s}from"./ContactController-aba72802.js";const e=document.querySelector("[data-add-product]"),l=document.querySelector("[data-form-product]");let c={},d;const w=async o=>{o.preventDefault();const r={imageUrl:e.querySelector('[id="url"]').value,category:e.querySelector('[id="category"]').value,name:e.querySelector('[id="name"]').value,price:e.querySelector('[id="price"]').value,description:e.querySelector('[id="description"]').value};if(console.log(r),Object.values(r).includes("")){const t=s("error","Todos los campos son obligatorios");l.insertBefore(t,e),setTimeout(()=>{t.remove()},3e3);return}if(r.name.length>20){const t=s("error","El nombre debe tener menos de 20 caracteres");l.insertBefore(t,e),setTimeout(()=>{t.remove()},3e3);return}if(r.description.length>150){const t=s("error","La descripciÃ³n debe tener menos de 150 caracteres");l.insertBefore(t,e),setTimeout(()=>{t.remove()},3e3);return}if(d){await g(r,c.id),window.location.href="../views/products.html";return}await v(r),window.location.href="../views/products.html"},h=async()=>{const o=await S();console.log(o),o.forEach(r=>{const{id:t,category:a}=r,i=document.querySelector("#category"),n=document.createElement("option");n.value=a,n.textContent=a,i.appendChild(n)})};document.addEventListener("DOMContentLoaded",async()=>{const o=JSON.parse(sessionStorage.getItem("user"));console.log(o),o||(window.location.href="../index.html"),h();const t=new URL(window.location.href).searchParams.get("id"),a=document.querySelector("[data-form-title]"),i=document.querySelector("[data-form-submit]");if(t)if(c=await y(t),c){console.log(c);const{category:n,description:u,id:q,imageUrl:m,name:f,price:p}=c;d=!0,a.textContent="Editar Producto",i.value="Editar",e.querySelector('[id="url"]').value=m,e.querySelector('[id="category"]').value=n,e.querySelector('[id="name"]').value=f,e.querySelector('[id="price"]').value=p,e.querySelector('[id="description"]').value=u;return}else window.location.href="../views/products.html";d=!1,a.textContent="Agregar Nuevo Producto",i.value="Agregar"});e.addEventListener("submit",w);
