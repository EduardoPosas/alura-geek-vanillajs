import"./style-952d8456.js";import{b as p,u as v,c as y}from"./ProductService-4ab90952.js";import{C as S}from"./CategoryService-5452352c.js";import{a as l}from"./ContactController-aba72802.js";const e=document.querySelector("[data-add-product]"),s=document.querySelector("[data-form-product]");let i={},d;const w=async o=>{o.preventDefault();const r={imageUrl:e.querySelector('[id="url"]').value,category:e.querySelector('[id="category"]').value,name:e.querySelector('[id="name"]').value,price:e.querySelector('[id="price"]').value,description:e.querySelector('[id="description"]').value};if(console.log(r),Object.values(r).includes("")){const t=l("error","Todos los campos son obligatorios");s.insertBefore(t,e),setTimeout(()=>{t.remove()},3e3);return}if(r.name.length>20){const t=l("error","El nombre debe tener menos de 20 caracteres");s.insertBefore(t,e),setTimeout(()=>{t.remove()},3e3);return}if(r.description.length>150){const t=l("error","La descripciÃ³n debe tener menos de 150 caracteres");s.insertBefore(t,e),setTimeout(()=>{t.remove()},3e3);return}if(d){await v(r,i.id),window.location.href="/alura-geek-vanillajs/views/products.html";return}await y(r),window.location.href="/alura-geek-vanillajs/views/products.html"},h=async()=>{const o=await S();console.log(o),o.forEach(r=>{const{id:t,category:a}=r,c=document.querySelector("#category"),n=document.createElement("option");n.value=a,n.textContent=a,c.appendChild(n)})};document.addEventListener("DOMContentLoaded",async()=>{const o=JSON.parse(sessionStorage.getItem("user"));console.log(o),o||(window.location.href="/alura-geek-vanillajs/index.html"),h();const t=new URL(window.location.href).searchParams.get("id"),a=document.querySelector("[data-form-title]"),c=document.querySelector("[data-form-submit]");if(t)if(i=await p(t),i){console.log(i);const{category:n,description:u,id:q,imageUrl:m,name:g,price:f}=i;d=!0,a.textContent="Editar Producto",c.value="Editar",e.querySelector('[id="url"]').value=m,e.querySelector('[id="category"]').value=n,e.querySelector('[id="name"]').value=g,e.querySelector('[id="price"]').value=f,e.querySelector('[id="description"]').value=u;return}else window.location.href="/alura-geek-vanillajs/views/products.html";d=!1,a.textContent="Agregar Nuevo Producto",c.value="Agregar"});e.addEventListener("submit",w);
