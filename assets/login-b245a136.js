import"./style-952d8456.js";import{a}from"./ContactController-aba72802.js";const n=async s=>{const r=`https://alura-geek-api-e8fc.onrender.com/users?email=${s}&_limit=1`;try{const o=await fetch(r);if(!o.ok)throw new Error("Error al obtener usuario");return o.json()}catch{console.log("Error en la petición")}},t=document.querySelector("[data-login]"),i=document.querySelector("[data-login-container]"),l=s=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(s),c=async s=>{s.preventDefault();const r={email:t.querySelector('[id="email"]').value,password:t.querySelector('[id="password"]').value};if(Object.values(r).includes("")){const e=a("error","Todos los campos son obligatorios");i.insertBefore(e,t),setTimeout(()=>{e.remove()},3e3);return}else if(!l(r.email)){const e=a("error","Email no válido");i.insertBefore(e,t),setTimeout(()=>{e.remove()},3e3);return}const[o]=await n(r.email);if(!o){const e=a("error","Usuario no existe");i.insertBefore(e,t),setTimeout(()=>{e.remove()},3e3);return}if(r.password!==o.password){const e=a("error","Contraseña incorrecta");i.insertBefore(e,t),setTimeout(()=>{e.remove()},3e3);return}sessionStorage.setItem("user",JSON.stringify({email:o.email,isAdmin:!0})),window.location.href="/alura-geek-vanillajs/views/products.html"};t.addEventListener("submit",c);
